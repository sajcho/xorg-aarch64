# Description:	X compat server to be used with wayland
# URL:		https://wayland.freedesktop.org/xserver.html
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	dbus egl-wayland xorg-server

name=xwayland
version=21.1.3
release=1
source=(https://xorg.freedesktop.org/releases/individual/xserver/${name}-${version}.tar.xz)

build() {
	cd ${name}-${version}

	build-meson \
		-Dxwayland_eglstream=true \
		-Dxkb_dir=/usr/share/X11/xkb \
		-Dxkb_output_dir=/var/lib/xkb \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -v -C build

	DESTDIR=$PKG meson install --no-rebuild -C build

	rm $PKG/usr/lib/xorg/protocol.txt
	rm $PKG/usr/share/man/man1/Xserver.1
}
